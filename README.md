# Examine_alerts_logs_and_rules

<h1>Lab 5</h1>

<h2>Description</h2>
Scenario<br>
In this scenario, I must monitor traffic on your employer's network. I will be required to configure Suricata and use it to trigger alerts.<br>

Here’s how I will do this task:<br> First, I will explore custom rules in Suricata.<br> Second, I will run Suricata with a custom rule in order to trigger it, and examine the output logs in the fast.log file.<br> Finally, I will examine the additional output that Suricata generates in the standard eve.json log file.

For the purposes of the tests I will run in this lab activity, I have been supplied with a sample.pcap file and a custom.rules file. These reside in the home folder.<br><br>

Defining Files I’ll be working with in this lab activity:<br>

The sample.p cap file is a packet capture file that contains an example of network traffic data, which you’ll use to test the Suricata rules. This will allow you to simulate and repeat the exercise of monitoring network traffic.<br>

The custom.rules file contains a custom rule when the lab activity starts. You’ll add rules to this file and run them against the network traffic data in the sample.pcap file.<br>

The fast.log file will contain the alerts that Suricata generates. The fast.log file is empty when the lab starts. <br>Each time I test a rule, or set of rules, against the sample network traffic data, Suricata adds a new alert line to the fast.<br>log file when all the conditions in any of the rules are met. The fast.log file can be located in the /var/log/suricata directory after Suricata runs.<br>The fast.log file is considered to be a depreciated format and is not recommended for incident response or threat hunting tasks but can be used to perform quick checks or tasks related to quality assurance.<br>

The eve.json file is the main, standard, and default log for events generated by Suricata.<br> It contains detailed information about alerts triggered, as well as other network telemetry events, in JSON format. <br>The eve.json file is generated when Suricate runs, and can also be located in the /var/log/suricata directory.<br>

When i create a new rule, I'll need to test the rule to confirm whether or not it worked as expected.<br> I will use the fast.log file to quickly compare the number of alerts generated each time I run Suricata to test a signature against the sample.pcap file.<br>

<br />


<h2>Languages and Utilities Used</h2>

- <b>Bash shell</b> 
- <b>Bash</b>

<h2>Environments Used </h2>

- <b>Qwiklabs (Provided by Coursera [Google Cybersecurity course])</b>

<h2>Program walk-through:</h2>

<p align="center">
Launch and Start : <br/>
<img src="https://imgur.com/dr3X6nt.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/zQ2QAqc.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Examine a custom rule in Suricata<br>  
  <br/>
<img src="https://imgur.com/pB1Whqb.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Trigger a custom rule in Suricata<br>
 1. List the files in the /var/log/suricata folder<br>
 2. Run suricata using the custom.rules and sample.pcap files<br>
 3. List the files in the /var/log/suricata folder again<br>
 4. Display the fast.log file generated by Suricata:<br>
  <br/>
<img src="https://imgur.com/eTtNdGE.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>

<br />
<br />
Examine eve.json output<br> 
 1. Display the entries in the eve.json file: <br>
 2. Display the entries in an improved format: <br>
 3. Return to the command-line prompt.<br>
 4. Extract specific event data from the eve.json file<br>
 5. Display all event logs related to a specific flow_id from the eve.json file. The flow_id value is a 16-digit number and will vary for each of the log entries.
  
  <br/>
<img src="https://imgur.com/R6xR9zU.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/EY70GDB.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/JNSBCal.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/uxjH3UK.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />


<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
